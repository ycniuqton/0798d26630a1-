{% extends "layouts/base-auth.html" %}
{% load static %}
{% load i18n %}

{% block extrastyle %}
<style>
.auth-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    background: #f6f7fb;
}
.auth-content {
    max-width: 450px;
    width: 90%;
    padding: 30px;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
.btn-google {
    color: #545454;
    background-color: #ffffff;
    border: 1px solid #dadce0;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
    padding: 10px;
    text-decoration: none;
}
.btn-google:hover {
    background-color: #f8f9fa;
    box-shadow: 0 2px 4px rgba(0,0,0,0.12);
    color: #545454;
    text-decoration: none;
}
.divider {
    text-align: center;
    margin: 20px 0;
    position: relative;
}
.divider::before,
.divider::after {
    content: "";
    position: absolute;
    top: 50%;
    width: 45%;
    height: 1px;
    background: #ddd;
}
.divider::before { left: 0; }
.divider::after { right: 0; }
.form-group {
    margin-bottom: 1rem;
}
.form-control {
    border-radius: 8px;
    padding: 0.75rem 1rem;
}
.error-message {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
}
</style>
{% endblock extrastyle %}

{% block content %}
<div class="auth-wrapper">
    <div class="auth-content">
        <div class="text-center mb-4">
            <h4>Create an Account</h4>
            <p>Get started with your free account today.</p>
        </div>

        <!-- Google OAuth2 Sign In -->
        <a href="{% url 'oauth2_init' %}?mode=register" class="btn btn-google mb-3">
            <img src="https://www.google.com/favicon.ico" alt="Google" width="20" height="20">
            Sign up with Google
        </a>

        <div class="divider">or</div>

        <form method="post" novalidate>
            {% csrf_token %}
            
            <div class="form-group">
                <label for="{{ form.username.id_for_label }}">Username</label>
                {{ form.username }}
                {% if form.username.errors %}
                    <div class="error-message">{{ form.username.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.email.id_for_label }}">Email</label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="error-message">{{ form.email.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="{{ form.first_name.id_for_label }}">First Name</label>
                        {{ form.first_name }}
                        {% if form.first_name.errors %}
                            <div class="error-message">{{ form.first_name.errors.0 }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="{{ form.last_name.id_for_label }}">Last Name</label>
                        {{ form.last_name }}
                        {% if form.last_name.errors %}
                            <div class="error-message">{{ form.last_name.errors.0 }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="{{ form.password1.id_for_label }}">Password</label>
                {{ form.password1 }}
                {% if form.password1.errors %}
                    <div class="error-message">{{ form.password1.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.password2.id_for_label }}">Confirm Password</label>
                {{ form.password2 }}
                {% if form.password2.errors %}
                    <div class="error-message">{{ form.password2.errors.0 }}</div>
                {% endif %}
            </div>

            <button type="submit" class="btn btn-primary w-100">Create Account</button>
        </form>

        <div class="text-center mt-4">
            <p>Already have an account? <a href="{% url 'login' %}">Sign in</a></p>
        </div>
    </div>
</div>
{% endblock content %}

{% block extra_js %}
<script>
document.querySelectorAll('.form-control[type="password"]').forEach(input => {
    const wrapper = document.createElement('div');
    wrapper.style.position = 'relative';
    input.parentNode.insertBefore(wrapper, input);
    wrapper.appendChild(input);

    const toggle = document.createElement('button');
    toggle.type = 'button';
    toggle.className = 'btn btn-link';
    toggle.style.cssText = 'position: absolute; right: 0; top: 50%; transform: translateY(-50%); border: none;';
    toggle.innerHTML = '<i class="fas fa-eye"></i>';
    
    toggle.addEventListener('click', () => {
        if (input.type === 'password') {
            input.type = 'text';
            toggle.innerHTML = '<i class="fas fa-eye-slash"></i>';
        } else {
            input.type = 'password';
            toggle.innerHTML = '<i class="fas fa-eye"></i>';
        }
    });
    
    wrapper.appendChild(toggle);
});
</script>
{% endblock extra_js %}
