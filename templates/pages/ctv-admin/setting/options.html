
{% block extrastyle %}
<style>
    .iframe-container {display: flex; width: 100%; height: 100%; flex-direction: column; overflow: hidden;}
    .parent-fit { flex-grow: 1; border: none; margin: 0; padding: 0; height: 100vh; }

    .card-header{
        padding-top:7px !important;
        padding-bottom:7px !important;
    }
</style>
{% endblock extrastyle %}

{% block content %}
<div class="container mt-4">
    <div class="row" hidden>
        <!-- Left Column: Big (8 columns) -->
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">VPS Configuration</h5>
                </div>
                <div class="card-body">
                    <form>
                        <!-- Select Plan -->
                        <div class="form-group">
                            <label for="select-plan">Select Plan</label>
                            <select class="form-control" id="select-plan">
                                <option>plan 4/8/50</option>
                            </select>
                        </div>

                        <!-- Backup Plan -->
                        <div class="form-group">
                            <label for="backup-plan">Backup Plan</label>
                            <select class="form-control" id="backup-plan">
                                <option>Same as VPS Plan</option>
                            </select>
                        </div>

                        <!-- Hostname -->
                        <div class="form-group">
                            <label for="hostname">Hostname</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="hostname" value="test">
                                <div class="input-group-append">
                                    <button class="btn btn-link" type="button"><i class="fas fa-edit"></i></button>
                                </div>
                            </div>
                        </div>

                        <!-- Username -->
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" class="form-control" id="username" placeholder="">
                        </div>

                        <!-- VPS Root Password -->
                        <div class="form-group">
                            <label for="vps-password">VPS Root Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="vps-password">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="password-strength">Strength Indicator</span>
                                    <button class="btn btn-primary" type="button"><i class="fas fa-search"></i></button>
                                </div>
                            </div>
                        </div>

                        <!-- IP Address -->
                        <div class="form-group">
                            <label for="ip-address">IP Address</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="ip-address" value="103.195.238.234">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" type="button"><i class="fas fa-times"></i></button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Right Column: Small (4 columns) -->
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Additional Configuration</h5>
                </div>
                <div class="card-body">
                    <form>
                        <!-- Disk Space -->
                        <div class="form-group">
                            <label for="disk-space">Disk Space</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="disk-space" value="50.000">
                                <div class="input-group-append">
                                    <span class="input-group-text">GB</span>
                                </div>
                            </div>
                            <a href="#">d83WXc55EOiQi2lU</a>
                        </div>

                        <!-- Guaranteed RAM -->
                        <div class="form-group">
                            <label for="ram">Guaranteed RAM</label>
                            <input type="number" class="form-control" id="ram" value="8196">
                        </div>

                        <!-- Storage -->
                        <div class="form-group">
                            <label for="storage">Storage</label>
                            <select class="form-control" id="storage">
                                <option>kvm1 (3246.89GB Free)</option>
                            </select>
                        </div>

                        <!-- Free Disk Space -->
                        <div class="form-group">
                            <label for="free-space">Free Disk Space</label>
                            <input type="text" class="form-control" id="free-space" value="252707 MB Free" disabled>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Third Block: New Form Elements (8 columns wide) -->
    <div class="row" hidden>
        <div class="col-md-12">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Other Settings</h5>
                </div>
                <div class="card-body">
                    <form>
                        <!-- Date Time Picker -->
                        <div class="form-group">
                            <label for="date-time">Select Date and Time</label>
                            <input type="datetime-local" class="form-control" id="date-time">
                        </div>

                        <!-- Item Picker -->
                        <div class="form-group">
                            <label for="item-picker">Item Picker</label>
                            <div class="row">
                                <!-- Available Items -->
                                <div class="col-6">
                                    <label>Available Items</label>
                                    <ul class="list-group">
                                        <li class="list-group-item">Item 1</li>
                                        <li class="list-group-item">Item 2</li>
                                        <li class="list-group-item">Item 3</li>
                                    </ul>
                                </div>
                                <!-- Selected Items -->
                                <div class="col-6">
                                    <label>Selected Items</label>
                                    <ul class="list-group">
                                        <li class="list-group-item">Item A</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Styled Radio Buttons -->
                        <div class="form-group">
                            <label>Select Option</label>
                            <div class="custom-control custom-radio">
                                <input type="radio" id="customRadio1" name="customRadio" class="custom-control-input">
                                <label class="custom-control-label" for="customRadio1">Option 1</label>
                            </div>
                            <div class="custom-control custom-radio">
                                <input type="radio" id="customRadio2" name="customRadio" class="custom-control-input">
                                <label class="custom-control-label" for="customRadio2">Option 2</label>
                            </div>
                        </div>

                        <!-- Styled Checkboxes -->
                        <div class="form-group">
                            <label>Select Features</label>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="customCheck1">
                                <label class="custom-control-label" for="customCheck1">Feature 1</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="customCheck2">
                                <label class="custom-control-label" for="customCheck2">Feature 2</label>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Suspend Config</h5>
        </div>
        <div class="card-body">
            <form id="suspend-config-form">
                <div class="form-group">
                    <label for="invoice-due-days">Invoice Due Days</label>
                    <input type="number" class="form-control" id="invoice-due-days" min="0"
                           placeholder="Enter invoice due days" required>
                </div>
                <div class="form-group">
                    <label for="suspend-days">Sufficient Balance Suspend Days</label>
                    <input type="number" class="form-control" id="suspend-days" min="0"
                           placeholder="Enter sufficient balance suspend days" required>
                </div>
                <button type="button" class="btn btn-primary" id="update-button">Update</button>
                <button type="button" class="btn btn-secondary" id="clear-button">Clear</button>
            </form>
        </div>
    </div>

    <div class="row">
        <!-- Left Column: Big (8 columns) -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">VPS Configuration</h5>
                </div>
                <div class="card-body">
                    <form>
                        <div class="form-group">
                            <label for="invoice-due-days">VPS auto archive</label>
                            <input type="number" class="form-control" id="vps-auto-archive" min="0"
                                   placeholder="Enter vps auto archive hour" required>
                        </div>

                        <button type="button" class="btn btn-primary" id="update-vps-config-button">Update</button>
                        <button type="button" class="btn btn-secondary" id="clear-vps-config-button">Clear</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-6">
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Cache Setting</h5>
        </div>
        <div class="card-body">
            <form>
                <table class="table table-borderless">
                    <tbody>
                        <tr>
                            <td>Plan</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('plan')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>OS</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('os')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>Server</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('server')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>Server Group</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('server_group')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>Full Server Group</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('full_server_group')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>Cluster</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('cluster')">Clear</button></td>
                        </tr>
                        <tr>
                            <td>All</td>
                            <td><button type="button" class="btn btn-link text-danger p-0" onclick="clearCache('all')">Clear</button></td>
                        </tr>
                    </tbody>
                </table>
            </form>
        </div>
    </div>
</div>

<style>
    /* Style adjustments for a clean look */
    .table {
        border-collapse: collapse;
    }
    .table td {
        padding: 0.5rem 0; /* Adjust padding for a cleaner layout */
        border: none; /* Remove borders */
    }
    .btn-link {
        text-decoration: none; /* Remove underline from button */
        font-weight: bold; /* Make button text bold */
    }
</style>

<script>
    function clearCache(name) {
        let url = '/api/admin/clear_cache/';
        let data = name === 'all' ? {} : { [name]: true };

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            alert(`${name === 'all' ? 'All caches' : name} cache cleared successfully!`);
        })
        .catch(error => {
            console.error('Error clearing cache:', error);
        });
    }
</script>


    </div>


</div>


<script>

    // Function to load suspend config from API
    async function loadSuspendConfig() {
        try {
            const response = await fetch('/api/admin/suspend_config/'); // GET request to the updated API endpoint
            const data = await response.json();
            document.getElementById('invoice-due-days').value = data.invoice_due_days || 0;
            document.getElementById('suspend-days').value = data.sufficient_balance_suspend_days || 0;
        } catch (error) {
            console.error('Error loading suspend config:', error);
        }
    }

    // Function to update suspend config via API
    async function updateSuspendConfig() {
        const invoiceDueDays = document.getElementById('invoice-due-days').value;
        const suspendDays = document.getElementById('suspend-days').value;

        const payload = {
            invoice_due_days: Number(invoiceDueDays),
            sufficient_balance_suspend_days: Number(suspendDays)
        };

        try {
            const response = await fetch('/api/admin/suspend_config/', { // POST request to the updated API endpoint
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload),
            });

            if (!response.ok) {
                throw new Error('Failed to update suspend config');
            }

            alert('Suspend config updated successfully');
        } catch (error) {
            console.error('Error updating suspend config:', error);
            alert('Failed to update suspend config');
        }
    }

    // Function to clear form inputs and reload data
    function clearSuspendConfig() {
        loadSuspendConfig(); // Reload data to clear unsaved changes
    }

    // Event listeners
    document.getElementById('update-button').addEventListener('click', updateSuspendConfig);
    document.getElementById('clear-button').addEventListener('click', clearSuspendConfig);

    loadSuspendConfig(); // Load suspend config when the page loads
</script>



<script>

    // Function to load suspend config from API
    async function loadVpsConfig() {
        try {
            const response = await fetch('/api/admin/vps_config/'); // GET request to the updated API endpoint
            const data = await response.json();
            document.getElementById('vps-auto-archive').value = data.vps_auto_archive || 0;
        } catch (error) {
            console.error('Error loading suspend config:', error);
        }
    }

    // Function to update suspend config via API
    async function updateVpsConfig() {
        const vps_auto_archive = document.getElementById('vps-auto-archive').value;

        const payload = {
            vps_auto_archive: Number(vps_auto_archive),
        };

        try {
            const response = await fetch('/api/admin/vps_config/', { // POST request to the updated API endpoint
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload),
            });

            if (!response.ok) {
                throw new Error('Failed to update suspend config');
            }

            alert('Vps config updated successfully');
        } catch (error) {
            console.error('Error updating vps config:', error);
            alert('Failed to update vps config');
        }
    }

    // Function to clear form inputs and reload data
    function clearVpsConfig() {
        loadVpsConfig(); // Reload data to clear unsaved changes
    }

    // Event listeners
    document.getElementById('update-vps-config-button').addEventListener('click', updateVpsConfig);
    document.getElementById('clear-vps-config-button').addEventListener('click', clearVpsConfig);

    loadVpsConfig(); // Load suspend config when the page loads
</script>

{% endblock content %}
